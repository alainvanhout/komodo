<!DOCTYPE HTML>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
          integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"/>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
            integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
            crossorigin="anonymous"></script>
</head>
<body>
<div class="container">
    <h1>Overview
        <a style="float:right" class="btn btn-default" href="reload">reload</a>
    </h1>


    <div id="accordion" class="panel-group" th:each="plan : ${plans}">

        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <span data-toggle="collapse" data-parent="#accordion" th:href="'#' + ${plan.action.name}">
                        <span th:text="${plan.action.name}"/>
                        <span style="float:left; padding-right:15px">
                            <div th:if="${plan.active} == true" th:remove="tag">
                                <span th:if="${plan.action.state.last} == null">
                                    <span style="color:#ff7864" class="glyphicon glyphicon-question-sign" aria-hidden="true"></span>
                                </span>
                                <span th:if="${plan.action.state.last} != null">
                                    <span th:if="${plan.action.state.successful} == true">
                                        <span style="color:green" class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                    </span>
                                    <span th:if="${plan.action.state.successful} == false">
                                        <span style="color:red" class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </span>
                                </span>

                            </div>
                            <div th:if="${plan.active == false} " th:remove="tag">
                                <span style="color:grey" class="glyphicon glyphicon-pause" aria-hidden="true"></span>
                            </div>
                        </span>
                        <span th:unless="${plan.action.state.last} == null" style="float:right">
                            <small style="margin-right:10px" th:text="${#temporals.format(plan.action.state.getLast(), 'yyyy-MM-dd')}"/>
                            <span th:text="${#temporals.format(plan.action.state.getLast(), 'HH:mm:ss')}"/><small th:text="${#temporals.format(plan.action.state.getLast(), ',SSS')}"/>
                        </span>
                    </span>
                </h4>
            </div>
            <div th:id="${plan.action.name}" class="panel-collapse collapse">
                <div class="panel-body">
                    <div>
                        <div>
                            <table class="table table-striped">
                                <thead>
                                    <th></th>
                                    <th>Config key</th>
                                    <th>Raw value</th>
                                    <th>Interpreted value</th>
                                </thead>
                                <tbody>
                                <tr th:each="configEntry : ${plan.action.fullConfig}">
                                    <td th:text="${plan.action.config.containsKey(configEntry.key) ? 'internal' : 'external'}"></td>
                                    <td th:text="${configEntry.key}"></td>
                                    <td th:text="${configEntry.value}"></td>
                                    <td th:text="${plan.action.get(configEntry.key)}"></td>
                                </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>
                    <div>
                        <div>Actions:</div>
                        <ul>
                            <li th:each="action : ${plan.action.check}">
                                <span th:text="${action.runner}"/>
                                <span th:if="${action.state.successful} == true"> OK</span>
                                <span th:if="${action.state.successful} == false"> Failure </span>
                                <span th:if="${action.state.successful} == null"> ?</span>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <div>Interval: <span th:text="${plan.interval}"/></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
</body>
</html>
